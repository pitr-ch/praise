<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<title>
  File: README_FULL
  
    &mdash; Praise
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README_FULL</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><h1>Praise</h1>

<p>Pry + raise = praise. A small gem for intercepting raise calls to dig up hidden and buried exceptions.</p>

<ul>
<li>  Documentation: <a href="http://blog.pitr.ch/praise">http://blog.pitr.ch/praise</a></li>
<li>  Source: <a href="https://github.com/pitr-ch/praise">https://github.com/pitr-ch/praise</a></li>
<li>  Blog: <a href="http://blog.pitr.ch/blog/categories/praise/">http://blog.pitr.ch/blog/categories/praise/</a></li>
</ul>

<h2>Difference between <code>prise</code> and <code>pry-rescue</code></h2>

<p>Praise allows a developer to investigate all exceptions including the ones rescued later.
<code>pry-rescue</code> on the other hand will work only for exceptions which are un-handled by the process.
Typical use-case is e.g. a worker, which is rescuing all exceptions. <code>pry-rescue</code> cannot help with
investigation of these exceptions.</p>

<h2>Install</h2>

<ol>
<li> require the gem early, e.g. in <code>contig/application.rb</code> in rails</li>
<li><p>install <code>Praise</code>, e.g.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Praise</span> <span class='op'>=</span> <span class='const'>PraiseImpl</span><span class='period'>.</span>
    <span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_root'>root</span><span class='comma'>,</span> <span class='const'>Katello</span><span class='period'>.</span><span class='id identifier rubyid_early_config'>early_config</span><span class='period'>.</span><span class='id identifier rubyid_praise'>praise</span><span class='period'>.</span><span class='id identifier rubyid_ignored_path'>ignored_path</span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='tlambda'>-&gt;</span> <span class='id identifier rubyid_level'>level</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='tlambeg'>{</span> <span class='const'>Logging</span><span class='period'>.</span><span class='id identifier rubyid_logger'>logger</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>praise</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span> <span class='const'>Logging</span><span class='period'>.</span><span class='id identifier rubyid_level_num'>level_num</span><span class='lparen'>(</span><span class='id identifier rubyid_level'>level</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
</code></pre></li>
</ol>

<p>And that&#39;s it.</p>

<h2>Usage</h2>

<p>Whenever an exception is risen and exception is not ignored then you will be dropped to a Pry session.</p>

<pre class="code ruby"><code class="ruby">From: /Users/pitr/Workspace/personal/praise/lib/praise.rb @ line 75 Kernel#raise:

    64: define_method :raise do |*args|
    65:   begin
    66:     message             = args.find { |o| o.kind_of? String }
    67:     backtrace           = args.find { |o| o.kind_of? Array }
    68:     exception_generator = args.find { |o| ![message, backtrace].include? o } || RuntimeError
    69:     exception           = message ? exception_generator.exception(message) : exception_generator.exception
    70:     message             ||= exception.message
    71:     risen_at            = caller(1).first
    72:
    73:     unless Thread.current[:__pry_in_rescue__] || praise.ignore?(exception, message, risen_at)
    74:       Thread.current[:__pry_in_rescue__] = true
 =&gt; 75:       binding.pry
    76:     end
    77:
    78:     _original_raise *args
    79:   ensure
    80:     Thread.current[:__pry_in_rescue__] = false
    81:   end
    82: end

[1] pry(#&lt;Delayed::Backend::ActiveRecord::Job&gt;)&gt;
</code></pre>

<p>Stack can be explored with pry-stack_explorer plugin for Pry:</p>

<pre class="code ruby"><code class="ruby">pry-stack_explorer (v0.4.9)
  down               Go down to the callee's context.
  frame              Switch to a particular frame.
  show-stack         Show all frames
  up                 Go up to the caller's context.
</code></pre>

<p>Use <code>up</code> or <code>frame 1</code> to get to the binding and line where the exception was risen.
When you hit <code>C-d</code> exception is risen as usual.</p>

<h2>Ignoring</h2>

<p>If there were no method to ignore some exceptions, It would drop to pry for every single <code>#raise</code> call, which
would not be very useful. Therefore there is a yml file where filters can be specified to ignore exceptions.
It can be updated at runtime <span class='object_link'><a href="PraiseImpl.html#add_rule-instance_method" title="PraiseImpl#add_rule (method)">PraiseImpl#add_rule</a></span>.</p>

<h3>Ignore file structure</h3>

<pre class="code ruby"><code class="ruby"><span class='lbracket'>[</span><span class='lbrace'>{</span> <span class='label'>class:</span>   <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>AClass</span><span class='tstring_end'>'</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>         <span class='comment'># exception ignored when exception.class.to_s == 'AClass'
</span> <span class='lbrace'>{</span> <span class='label'>message:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>missing plugin</span><span class='regexp_end'>/</span></span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='comment'># exception ignored when exception.message =~ /missing plugin/
</span> <span class='lbrace'>{</span> <span class='label'>line:</span>    <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>rubygems</span><span class='regexp_end'>/</span></span> <span class='rbrace'>}</span><span class='comma'>,</span>       <span class='comment'># exception ignored when risen_at =~ /rubygems/
</span> <span class='lbrace'>{</span> <span class='label'>class:</span>   <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='label'>message:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>nothing</span><span class='regexp_end'>/</span></span> <span class='rbrace'>}</span>
 <span class='comment'># exception ignored when both rules are met
</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_yaml'>to_yaml</span>
</code></pre>
</div></div>

    <div id="footer">
  Generated on Fri May 17 11:07:39 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.6.1 (ruby-1.9.3) by <a href='http://blog.pitr.ch'>pitr.ch</a>.
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4005004-8', 'pitr.ch');
  ga('send', 'pageview');
</script>

  </body>
</html>